---
layout: post
title: "Kubuntu折腾记"
date:   2020-05-10 10:00:00 +0800
categories: linux
---

## 简述

说起Linux桌面环境，大学的时候，精力充沛折腾过不少日子。无非换换桌面，折腾配置，不亦乐乎。刚购置自己的PC机器的时候，萌生过装一个双系统。但是无线网卡不支持，就直接放弃了。

最近无聊，随手在京东搜索，想看看有没有支持Linux的无线网卡。因为我的印象，好像大部分不支持。这一搜，发现了一个有意思的知识。最终找到方法让Linux支持我买的无线网卡。有了前人的经验加持，就又有了这个折腾的想法。反正时间不用来折腾也会过去。

下面介绍一步一步遇到的问题，以及解决方法。

## 无线网卡

我买的是腾达U9无线网卡，官网写的是不支持Linux的。实际上，当我们遇到一个问题，如果接受了一个设定，那就容易困住自己的思维，难以跳出去。我接受了无线网卡不支持Linux这个设定，就完全没有去想为什么不支持了。本质上，是因为自己对硬件这块属于小白级别，所以，比较迷信了权威。这个是这次折腾的一个体会。

首先，USB无线网卡不是什么特别的东西，它本质是厂家包装无线网卡芯片的产品。例如小米，买了一堆别人硬件组装了一个手机品牌。通常的无线芯片厂家有`博通`，`高通`，`联发科`, `瑞昱`等等。我买的腾达U9就是用的瑞昱的芯片，英文叫`Realtek`，比较一般，所以不会在商品介绍那里写出来。既然用的是别人的芯片，那支不支持其实应该是芯片厂商说了算。

查了一下我买的这款型号，结果是没有官方驱动的。但是，总有大神有这种类似的支持Linux需求。所以，确实也找到了让Linux支持这个型号的芯片的驱动。在[这里](https://github.com/whitebatman2/rtl8821CU)。按照他的方法安装即可。

这里就遇到了第二个问题，我没有网，所以才要装无线网卡驱动上网。但是要装这个驱动，需要安装gcc等工具包。似乎陷入了死循环。

到这里，也可以先跳到下一步看怎么安装。

按照Github步骤，安装驱动以后就可以上网了。Github介绍了两个方法，一个是dkms安装，一个是普通安装。dkms是动态内核模块支持。如果不安装这个的话，我们的系统更新内核之后，之前安装的驱动可能就会失效了，需要重新构建安装。所以，最好是通过dkms这种方法安装驱动，即使内核更新，它也会自动处理。

## 离线安装构建包

恰好Ubuntu刚刚发布了20.04版本。于是，我就下载了这个版本尝鲜。安装完以后，确实是不带构建包的。然后，充分发挥搜索的能力，找到了解决方法。

其实完整版的Ubuntu ISO里面是带了底层的构建包的，在`ISO_PATH://pool/main/..`里面，进去就可以看到有很多deb包。所以，方法就是添加本地apt源。然后在本地安装这些软件。

```shell
mkdir /media/cdrom // 新建一个挂载点
sudo mount --bind /media/my_usb_driver_path /media/cdrom // 把我的启动U盘挂载到/meida/cdrom目录
sudo apt-cdrom add -d=/media/cdrom // 这一步就是添加本地源
sudo apt update
sudo apt install build-essential
```

上述几个步骤过后，就成功安装了构建工具。如果有报错，也不要着急，根据缺少的依赖，搜索ISO文件，找到目录，安装依赖就可以了。

```shell
sudo dpkg -i local_deb_file // 安装缺少的依赖
```

## 桌面环境

Ubuntu自带的是`Gnome 3.36`。我装上后，用的是真的不舒服。虽然比较简洁，但是给我的感觉更多是简陋。系统的动画卡顿，开机关机慢；窗口界面，其大无比的标题栏；响应有点慢；可定制性差等。总之，不是很喜欢。于是，换了KDE。

最终，KDE折腾下来，确实非常符合自己的喜好。虽然有一些BUG，但是瑕不掩瑜，总体是很不错的。方便的软件包管理；漂亮的UI；强大的界面配置，很高的定制化等等。如果配置好了，操作体验和osx相当，除了在应用软件生态上不足。当然，osx也不是很完美，例如Docker等软件，支持并不好。

不过，我本身也只是当业余写代码的系统，也满意了。总而言之，喜欢KDE。

上一张桌面图

![图片](/static/assert/imgs/kde.jpg)

## 最后

其实KDE桌面配置也有很多内容，但是这里就不介绍了，那些都是皮毛。不得不说，Linux做开发还是很舒服的，要装Go，nodejs等，直接`apt install`就可以了。配上国内的源，速度嗖嗖的。就在刚刚，写这个文章结尾，发现缺少`jekyll`环境。一个命令，还没写完就装好了。

期待KDE在性能和体验方面能越来越好。也希望国内厂商能花点功夫支持Linux应用软件生态。
